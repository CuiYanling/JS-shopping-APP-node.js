<!doctype html>
<html class="no-js">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>注册1</title>
    <!-- Set render engine for 360 browser -->
    <meta name="renderer" content="webkit">
    <!-- No Baidu Siteapp-->
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="icon" type="image/png" href="assets/i/pic_logo.png">
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="assets/i/app-icon72x72@2x.png">
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Amaze UI" />
    <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">
    <link rel="stylesheet" href="assets/css/amazeui.min.css">
    <link rel="stylesheet" href="assets/css/app.css">
    <link rel="stylesheet" type="text/css" href="css/regist3.css" />
    <link rel="stylesheet" type="text/css" href="css/regist.css" />
</head>

<body>
    <div class="wrap1">
        <div class="head-fixed">
            <span>注册分期乐账号</span>
            <a href="regist.html" class="go-back am-block">
                <i class="am-header-icon am-icon-angle-left" style="font-size: 30px;"></i>
            </a>
        </div>
        <div class="logo-banner txt-center">
            <img height="70" src="//cres1.fenqile.cn/passport/img/m/login/login_logo--2479b32e49.png" />
        </div>
        <!--错误提示-->
        <div class="tips-box" id="tips">
            <span></span>
        </div>
        <form action="" method="post" class="" id="form">
            <ul class="form-new ">
                <li class="form-input am-g">
                    <div class="am-u-sm-1">
                        <i class="icon icon-mobile "></i>
                    </div>
                    <div class="am-u-sm-10 am-margin-left-sm ">
                        <input class="txt12" type="text" name="reg1_ph" id="phone" value="" datatype="myphone" placeholder="输入本人手机号以验证" nullmsg='手机号不能为空 ' errormsg="手机号格式错误" />
                    </div>
                </li>
                <li class="form-input am-g relative">
                    <div class="am-u-sm-1">
                        <i class="icon icon-code "></i>
                    </div>
                    <div class="am-u-sm-10 am-margin-left-sm">
                        <input type="text" name="reg1_code" id="usercode" value="" placeholder="图片验证码" datatype="usercode" nullmsg="请输入验证码" />
                    </div>
                    <div id="v_container" style="width: 60px;height: 30px;"></div>
                </li>
                <li class="form-input am-g relative">
                    <div class="am-u-sm-1">
                        <i class="icon icon-sms "></i>
                    </div>
                    <div class="am-u-sm-10 am-margin-left-sm">
                        <input type="text" name="reg1_code2" id="" value="" placeholder="六位数字验证码" datatype="numcode" nullmsg="请输入六位数字验证码" errormsg="数字验证码格式错误" />
                    </div>
                    <div class="get-code blue">
                        获取验证码
                    </div>
                </li>
            </ul>
            <button class="am-btn am-btn-secondary" type="submit" id="next-btn">下一步</button>
        </form>
        <div class="register-benefit am-container">
            <ul class="am-g txt12">
                <li class="relative "><i class="icon reg-ico-01"></i>先消费后还款</li>
                <li class="relative"><i class="icon reg-ico-02"></i>万元额度可取现</li>
                <li class="relative"><i class="icon reg-ico-03"></i>40天免息</li>
            </ul>
        </div>
    </div>
    <div class="wrap2">
        <div class="head-fixed">
            <span>注册分期乐账号</span>
            <a href="" onClick="javascript :history.back(-1);" class="go-back am-block">
                <i class="am-header-icon am-icon-angle-left" style="font-size: 30px;"></i>
            </a>
        </div>
        <!--错误提示-->
        <div class="tips-box" id="tips2">
            <span></span>
        </div>
        <div class="title">
            请设置并牢记密码，已完成账号注册
        </div>
        <form action="" method="" class="am-margin-top-sm" id="form2">
            <ul class="form-new ">
                <li class="form-input am-g relative">
                    <div class="am-u-sm-3">
                        <label for="pwd1">登陆密码</label>
                    </div>
                    <div class="am-u-sm-9 ">
                        <input datatype="*6-16" type="password" name="pwd1" id="pwd1" value="" placeholder="请设置登录密码" nullmsg='必须设置一个登陆密码 ' />
                    </div>
                    <div class="pwd-eye">
                        <i class="icon icon-eye eye-btn" id="icon-eye1"></i>
                    </div>
                </li>
                <li class="form-input am-g relative">
                    <div class="am-u-sm-3">
                        <label for="pwd2">确认密码</label>
                    </div>
                    <div class="am-u-sm-9">
                        <input datatype="*6-16" type="password" name="pwd2" id="pwd2" recheck="pwd1" value="" placeholder="请再次输入登录密码" nullmsg='必须确认您的登陆密码' errormsg="请输入一致的密码" />
                    </div>
                    <div class="pwd-eye">
                        <i class="icon icon-eye eye-btn" id="icon-eye2"></i>
                    </div>
                </li>
            </ul>
            <div class="agree">
                同意
                <a href="">服务协议</a>
            </div>
            <button class="am-btn am-btn-secondary" type="submit" id="next-btn2">完成注册</button>
        </form>
    </div>
    <!--[if (gte IE 9)|!(IE)]><!-->
    <!--<![endif]-->
    <!--<script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>-->
    <!--<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>-->
    <!--<script src="assets/js/amazeui.ie8polyfill.min.js"></script>-->
    <script src="js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="assets/js/amazeui.min.js"></script>
    <script src="js/gVerify.js" type="text/javascript" charset="utf-8"></script>
    <!--<script src="js/Validform_v5.3.2_min.js" type="text/javascript" charset="utf-8"></script>-->
    <script src="js/regist.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/Validform_v5.3.2.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
    var verifyCode = new GVerify("v_container");
    $("#btn_sub").onclick = function() {}
    //表单验证
    var showmsg = function(msg) {
        $("#tips").text(msg);
        $("#tips").css("opacity", "1");
        $("#tips").css("display", "block");
    }
    $("#form").Validform({
        btnSubmit: "#next-btn",
        //          tiptype: 1,
        tiptype: function(msg) {
            showmsg(msg);
        },

        ignoreHidden: false,
        dragonfly: false,
        tipSweep: true,
        label: ".label",
        showAllError: false,
        postonce: true,
        //          ajaxPost: true,
        datatype: {
            "*6-20": /^[^\s]{6,20}$/,
            "z2-4": /^[\u4E00-\u9FA5\uf900-\ufa2d]{2,4}$/,
            "myphone": /^[1][3,4,5,7,8][0-9]{9}$/,
            "numcode": /^\d{6}$/,
            "usercode": function(gets, obj, curform, regxp) {
                var res = verifyCode.validate(document.getElementById("usercode").value);
                if (res) {
                    return true;
                } else {
                    return "验证码错误"
                }
            },
        },
        usePlugin: {
            swfupload: {},
            datepicker: {},
            passwordstrength: {},
            jqtransform: {
                selector: "select,input"
            }
        },
        beforeCheck: function(curform) {
            //                  if()
            //在表单提交执行验证之前执行的函数，curform参数是当前表单对象。
            //这里明确return false的话将不会继续执行验证操作;    
        },
        beforeSubmit: function(curform) {
            //在验证成功后，表单提交前执行的函数，curform参数是当前表单对象。
            //这里明确return false的话表单将不会提交;    
            // location.href = "regist2.html";
            // get请求
            $(".wrap1").css("display", "none");
            $(".wrap2").css("display", "block");
            return false;
        },
        callback: function(data) {
            //返回数据data是json对象，{"info":"demo info","status":"y"}
            //info: 输出提示信息;
            //status: 返回提交数据的状态,是否提交成功。如可以用"y"表示提交成功，"n"表示提交失败，在ajax_post.php文件返回数据里自定字符，主要用在callback函数里根据该值执行相应的回调操作;
            //你也可以在ajax_post.php文件返回更多信息在这里获取，进行相应操作；
            //ajax遇到服务端错误时也会执行回调，这时的data是{ status:**, statusText:**, readyState:**, responseText:** }；

            //这里执行回调操作;
            //注意：如果不是ajax方式提交表单，传入callback，这时data参数是当前表单对象，回调函数会在表单验证全部通过后执行，然后判断是否提交表单，如果callback里明确return false，则表单不会提交，如果return true或没有return，则会提交表单。
        }
    });

    function pwd_eye() {
        var flag = $("#icon-eye1").hasClass("icon-eye");
        if (flag) {
            $("#icon-eye1").parent(".pwd-eye").siblings().find("input").attr("type", "password")
        } else {
            $("#icon-eye1").parent(".pwd-eye").siblings().find("input").attr("type", "text");
        }
    }
    //密码可见
    var eyeFlag1 = true;
    $("#icon-eye1").click(function() {
        if (eyeFlag1) {
            $(this).removeClass("icon-eye").addClass("icon-eye1");
            pwd_eye();
            eyeFlag1 = !eyeFlag1;
        } else {
            $(this).removeClass("icon-eye1").addClass("icon-eye");
            pwd_eye();
            eyeFlag1 = !eyeFlag1;
        }
    })
    //判断密码是否可见
    function pwd_eye2() {
        var flag = $("#icon-eye2").hasClass("icon-eye");
        if (flag) {
            $("#icon-eye2").parent(".pwd-eye").siblings().find("input").attr("type", "password")
        } else {
            $("#icon-eye2").parent(".pwd-eye").siblings().find("input").attr("type", "text");
        }
    }
    //密码可见
    var eyeFlag2 = true;
    $("#icon-eye2").click(function() {
        if (eyeFlag2) {
            $(this).removeClass("icon-eye").addClass("icon-eye1");
            pwd_eye2();
            eyeFlag2 = !eyeFlag2;
        } else {
            $(this).removeClass("icon-eye1").addClass("icon-eye");
            pwd_eye2();
            eyeFlag2 = !eyeFlag2;
        }
    })
    //表单验证
    var showmsg2 = function(msg) {
        $("#tips2").text(msg);
        $("#tips2").css("opacity", "1");
        $("#tips2").css("display", "block");
    }
    //表单验证
    $("#form2").Validform({
        btnSubmit: "#next-btn2",
        //          tiptype: 1,
        tiptype: function(msg) {
            showmsg2(msg);
        },
        ignoreHidden: false,
        dragonfly: false,
        tipSweep: true,
        label: ".label",
        showAllError: false,
        postonce: true,
        //          ajaxPost: true,
        datatype: {
            "*6-20": /^[^\s]{6,20}$/,
            "z2-4": /^[\u4E00-\u9FA5\uf900-\ufa2d]{2,4}$/,
            "myphone": /^[1][3,4,5,7,8][0-9]{9}$/,
            "numcode": /^\d{6}$/,
        },
        usePlugin: {
            swfupload: {},
            datepicker: {},
            passwordstrength: {},
            jqtransform: {
                selector: "select,input"
            }
        },
        beforeCheck: function(curform) {
            //在表单提交执行验证之前执行的函数，curform参数是当前表单对象。
            //这里明确return false的话将不会继续执行验证操作;    
        },
        beforeSubmit: function(curform) {
            //在验证成功后，表单提交前执行的函数，curform参数是当前表单对象。
            //这里明确return false的话表单将不会提交;    
            // location.href = "index.html";
            // get请求
            var data = $("form").serialize();
            $.post('/users/regist/', data, function(data, textStatus, xhr) {
                /*optional stuff to do after success */
                if (data.status) {
                    // 储存账户状态
                    sessionStorage.myid = $("#phone").val();
                    // 跳转页面
                    location.href = "/mobile/index.html";
                } else {
                    alert(data.msg);
                }
            });
            return false;
        }
    });
    </script>
</body>

</html>